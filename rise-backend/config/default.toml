[server]
host = "0.0.0.0"
port = 3000
public_url = "http://localhost:3000"
cookie_domain = ""  # Empty = current host only (good for localhost)
cookie_secure = false  # Set to true for HTTPS in production

[auth]
issuer = "http://localhost:5556/dex"
client_id = "rise-backend"
client_secret = "rise-backend-secret"
# List of admin user emails (have full permissions on all resources)
admin_users = ["admin@example.com"]

[database]
url = "postgres://rise:rise123@localhost:5432/rise"

# Controller loop intervals (in seconds) - optional, all have defaults
[controller]
# How often to check for deployments to reconcile (default: 5)
# reconcile_interval_secs = 5
# How often to perform health checks on active deployments (default: 5)
# health_check_interval_secs = 5
# How often to process terminating deployments (default: 5)
# termination_interval_secs = 5
# How often to process cancelling deployments (default: 5)
# cancellation_interval_secs = 5
# How often to check for expired deployments (default: 60)
# expiration_interval_secs = 60
# How often to refresh Kubernetes image pull secrets (default: 3600)
# secret_refresh_interval_secs = 3600

# Container registry configuration (optional)
# Uncomment and configure ONE of the following registry providers:

# AWS ECR Example:
# [registry]
# type = "ecr"
# region = "us-east-1"
# account_id = "123456789012"
# access_key_id = "AKIAIOSFODNN7EXAMPLE"  # Optional: static credentials (use IAM role in production)
# secret_access_key = "wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY"
# repo_prefix = "rise/"
# role_arn = "arn:aws:iam::123456789012:policy/rise-ecr-controller"
# push_role_arn = "arn:aws:iam::123456789012:role/rise-ecr-push"
# auto_remove = true

# OCI registry for local development (client-side auth via docker login)
[registry]
type = "oci-client-auth"
registry_url = "localhost:5000"
namespace = "rise-apps"

# Kubernetes configuration (optional)
# Uncomment to enable Kubernetes deployment controller
#
# IMPORTANT: For ingress authentication to work, the backend API must be accessible
# on the same parent domain as your apps. Example setup:
#
# Production:
#   - Deploy backend with Ingress at https://api.rise.net
#   - Apps will be at https://{project}.apps.rise.net
#   - Set cookie_domain = ".rise.net" (note the leading dot)
#   - Set public_url = "https://api.rise.net"
#   - Set auth_signin_url = "https://api.rise.net"
#   - Set auth_backend_url = "http://rise-backend.default.svc.cluster.local:3000"
#
# Development (Minikube):
#   - Create Ingress for backend at http://api.rise.net
#   - Add to /etc/hosts: <minikube-ip> api.rise.net foo.apps.rise.net
#   - Set cookie_domain = ".rise.net"
#   - Set public_url = "http://api.rise.net"
#   - Set auth_signin_url = "http://api.rise.net"
#   - Set auth_backend_url = "http://172.17.0.1:3000" (Docker bridge IP for Minikube to reach host)
#
# [kubernetes]
# ingress_class = "nginx"
# domain_suffix = "apps.rise.net"
# namespace_format = "rise-{project_name}"  # Template for Kubernetes namespaces (default: "rise-{project_name}")
# auth_backend_url = "http://rise-backend.default.svc.cluster.local:3000"  # Internal cluster service URL for auth checks
# auth_signin_url = "https://api.rise.net"  # Public API URL for browser redirects during authentication
# kubeconfig = "/path/to/kubeconfig"  # Optional: explicit kubeconfig path
